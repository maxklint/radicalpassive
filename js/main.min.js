"use strict"
function main(){initGallery()
initNews()
if(document.body.hasAttribute("is-home"))
initHome()}
function Gallery(config){this.mini=document.body.querySelector("#"+config.miniId)
this.maxi=document.body.querySelector("#"+config.maxiId)
this.miniCounter=document.body.querySelector("#"+config.miniCounterId)
this.maxiCounter=document.body.querySelector("#"+config.maxiCounterId)
this.fullsize=config.fullsize?config.fullsize.split(","):null
this.thumbs=config.thumbs?config.thumbs.split(","):null
this.thumbs2x=config.thumbs2x?config.thumbs2x.split(","):null
this.maxAspect=config.maxAspect
this.maxHeight=config.maxHeight
this.fullscreen=config.fullscreen
this.index=0
this.size=this.fullsize.length
if(config.interval)
setInterval(this.showNext.bind(this),config.interval)
document.body.onresize=this.resize.bind(this)
this.resize()
if(config.keyboardControl){var gallery=this
document.addEventListener("keydown",function(event){if(event.key==="ArrowLeft")
gallery.showPrev()
if(event.key==="ArrowRight")
gallery.showNext()
if(event.key==="Escape")
gallery.collapse()})}}
Gallery.prototype.resize=function(){if(!this.mini||!this.maxAspect||this.maxAspect<=1||!this.maxHeight)
return
var containerWidth=this.mini.parentElement.clientWidth
var imageWidth=this.maxHeight*this.maxAspect
var scale=containerWidth/imageWidth
var height=Math.round(this.maxHeight*scale)
this.mini.style.height=height+"px"}
Gallery.prototype.show=function(index){this.index=index
if(this.fullscreen){this.maxi.setAttribute("src",this.fullsize[index])
if(this.maxiCounter)
this.maxiCounter.innerHTML=""+(index+1)+"/"+this.size}else{this.mini.setAttribute("src",this.thumbs[index])
this.mini.setAttribute("srcset",this.thumbs[index]+" 1x, "+
this.thumbs2x[index]+" 2x")
if(this.miniCounter)
this.miniCounter.innerHTML=""+(index+1)+"/"+this.size}}
Gallery.prototype.showNext=function(){this.show((this.index+1)%this.size)}
Gallery.prototype.showPrev=function(){this.show(this.index>0?this.index-1:this.size-1)}
Gallery.prototype.expand=function(){this.fullscreen=true
toggleClass(document.body.querySelector(".fullscreen"),"nodisplay")
toggleClass(document.body.querySelector("header"),"nodisplay")
toggleClass(document.body.querySelector(".content"),"nodisplay")
this.show(this.index)}
Gallery.prototype.collapse=function(){this.fullscreen=false
toggleClass(document.body.querySelector(".fullscreen"),"nodisplay")
toggleClass(document.body.querySelector("header"),"nodisplay")
toggleClass(document.body.querySelector(".content"),"nodisplay")
this.show(this.index)}
function initHome(){var menu=document.body.querySelector(".menu")
var fullscreen=document.body.querySelector(".fullscreen")
var logo=document.body.querySelector(".logo__link")
toggleClass(menu,"nodisplay")
window.onclick=function(){toggleClass(menu,"nodisplay")
toggleClass(fullscreen,"nodisplay")}
logo.onclick=function(event){event.preventDefault()}
menu.onclick=function(event){event.stopPropagation()}}
function initNews(){var news=document.body.querySelectorAll(".news__link")
function clickNews(elem){news.forEach(function(link){var parent=link.parentElement
if(link===elem)
toggleClass(parent,"news__listitem_open")
else
parent.classList.remove("news__listitem_open")})}
var preopen=document.body.querySelector("a[href='"+window.location.hash+"']")
if(preopen)clickNews(preopen)
news.forEach(function(target){target.onclick=function(event){clickNews(target)
event.preventDefault()}})}
function initGallery(){if(window.gallery)
window.gallery.show(0)}
function toggleClass(elem,cls){var classes=elem.classList
if(classes.contains(cls))
classes.remove(cls)
else
classes.add(cls)}
function createElement(kind,cls,attrs,styles){var elem=document.createElement(kind)
if(cls)
elem.className=cls
for(var key in attrs){if(!key)continue
if(attrs.hasOwnProperty(key)){var value=attrs[key]
if(!value)continue
elem.setAttribute(key,value)}}
for(var key in styles){if(!key)continue
if(styles.hasOwnProperty(key)){var value=styles[key]
if(!value)continue
elem.style[key]=value}}
return elem}